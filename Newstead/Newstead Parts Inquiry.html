<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Newstead Parts Inquiry</title>
</head>
<body>
<div class="container">
  <h1>Newstead Parts Inquiry</h1>
  <form id="partsInquiryForm">
    <p>Please fill out the form below to inquire about parts.</p>

    <label>Full Name:<input type="text" name="fullName" required></label><br>
    <label>Phone Number:<input type="tel" name="phoneNumber" required></label><br>
    <label>Email Address:<input type="email" name="email" required></label><br>
    <label>Car Make:<input type="text" name="carMake" required></label><br>
    <label>Queensland Registration Number / VIN:<input type="text" name="regoVin" required></label><br>
    <label>Date of Inquiry:<input type="date" name="dateOfInquiry" required></label><br>
    <label>Preferred Contact Method:<input type="text" name="contactMethod" required></label><br>

    <div id="partsContainer">
      <div class="part-item">
        <label>Part Name/Description:<input type="text" name="partName[]" required></label><br>
        <label>Part Number:<input type="text" name="partNumber[]"></label><br>
        <label>Quantity:<input type="number" name="quantity[]" required></label><br>
        <label>Notes:<textarea name="notes[]"></textarea></label><br>
      </div>
    </div>

    <button type="button" id="addPartBtn">+ Add Another Part</button><br><br>
    <button type="submit">Submit Inquiry</button>
  </form>
</div>

<script src="https://cdn.emailjs.com/dist/email.min.js"></script>
<script>
  emailjs.init("4Ql5nWlN68GuWu7tt"); // ✅ Replace with your EmailJS public key

  let partCount = 1;

  document.getElementById('addPartBtn').addEventListener('click', function () {
    partCount++;
    const newPart = document.createElement('div');
    newPart.classList.add('part-item');

    newPart.innerHTML = `
      <label>Part Name/Description:<input type="text" name="partName[]" required></label><br>
      <label>Part Number:<input type="text" name="partNumber[]"></label><br>
      <label>Quantity:<input type="number" name="quantity[]" required></label><br>
      <label>Notes:<textarea name="notes[]"></textarea></label><br>
    `;
    document.getElementById('partsContainer').appendChild(newPart);
  });

  document.getElementById("partsInquiryForm").addEventListener("submit", function (e) {
    e.preventDefault();

    const formData = new FormData(this);
    const parts = [];

    const partNames = formData.getAll('partName[]');
    const partNumbers = formData.getAll('partNumber[]');
    const quantities = formData.getAll('quantity[]');
    const notes = formData.getAll('notes[]');

    for (let i = 0; i < partNames.length; i++) {
      parts.push(`Part ${i+1}: ${partNames[i]}<br>Part Number: ${partNumbers[i] || '-'}<br>Quantity: ${quantities[i]}<br>Notes: ${notes[i] || '-'}<br><br>`);
    }

    const emailData = {
      fullName: formData.get('fullName'),
      phoneNumber: formData.get('phoneNumber'),
      email: formData.get('email'),
      carMake: formData.get('carMake'),
      regoVin: formData.get('regoVin'),
      dateOfInquiry: formData.get('dateOfInquiry'),
      contactMethod: formData.get('contactMethod'),
      parts: parts.join('')
    };

    emailjs.send("service_xp1cj3b", "template_vqc44cj", emailData) // ✅ Replace both
      .then(() => {
        alert("Your inquiry has been submitted!");
        document.getElementById("partsInquiryForm").reset();
        partCount = 1;
        document.getElementById("partsContainer").innerHTML = ''; // Clear old parts
      }, (error) => {
        alert("There was an error submitting the form. See console for details.");
        console.error(error);
      });
  });
</script>
</body>
</html>
